var suso={};!function(e){"use strict";e.EventAware=function(e){var t={};return e.on=function(r,n){return void 0===t[r]&&(t[r]=[]),t[r].push(n),e},e.off=function(r){return void 0===t[r]?e:(t[r]=[],e)},e.trigger=function(r){var n,o,i=t[r];if(void 0===i)return e;for(Array.prototype.splice.call(arguments,0,1),n=0;n<i.length;n+=1)o=i[n],void 0!==o&&"function"==typeof o&&o.apply(this,arguments);return e},e}}(suso),function(e){"use strict";e.filter=function(e,t){var r,n={};if(void 0===e||"object"!=typeof e)throw new Error("Filter object not specified");if(void 0===t||"function"!=typeof t)throw new Error("Filter function not specified");for(r in e)e.hasOwnProperty(r)&&"where"!==r&&"each"!==r&&t(e[r],r)&&(n[r]=e[r]);return n},e.forEach=function(e,t){var r,n,o={};if(void 0===e||"object"!=typeof e)throw new Error("ForEach object not specified");if(void 0===t||"function"!=typeof t)throw new Error("ForEach function not specified");for(r in e)e.hasOwnProperty(r)&&"where"!==r&&"each"!==r&&(n=t(e[r],r),o[r]=n||e[r]);return o}}(suso),function(e){"use strict";function t(){function t(e,t){a++,"ready"===c&&(f.trigger("update",f),f.trigger("report",e,t))}var r,n,o,i,s=[],l=[],u=[],c="init",a=0,p=[],f=this;for(n=0;9>n;n++)s.push(new e.House("block",n,f)),l.push(new e.House("col",n,f)),u.push(new e.House("row",n,f));for(n=0;81>n;n++)o=new e.Cell(this),o.on("update",t),o.setHouse(u[Math.floor(n/9)],"row"),o.setHouse(l[n%9],"col"),o.setHouse(s[Math.floor(n/3)%3+3*Math.floor(n/27)],"block");c="unseeded",this.seedSolved=p,this.state=function(){return c},this.rows=u,this.cols=l,this.vRow=function(e){return l[e]},this.hRow=function(e){return u[e]},this.block=function(e){return s[e]},this.allGroups=function(){return void 0===i&&(i=u.concat(l).concat(s)),i},this.addSeeds=function(e){var t,r,n;if("unseeded"!==c)return this;for(t=0;t<e.length;t++)for(r=0;r<e[t].length;r++)n=e[t][r],void 0!==n&&"number"==typeof n&&u[t].cells()[r].setValue(n);return c="ready",f.trigger("report",f,"grid seeded"),this},this.solve=function(){var t,n,o,i=!0;if("complete"===c||"incomplete"===c)return this;for(n=0;n<p.length;n++)o=p[n].possibleValues(),1===o.length&&p[n].setValue(o[0],"one remaining value after seeding");for(r=[e.rules.lastInGroup,e.rules.restrictedPossibleValue,e.rules.pairs,e.rules.hiddenpairs,e.rules.triples];i&&81!==a;)for(i=!1,t=0;t<r.length&&81!==a;t++)i=i||r[t](f);return c=81===a?"complete":"incomplete",f.trigger("report",f,"grid "+c),this}}e.Grid=function(){return new e.EventAware(new t)}}(suso),function(e){"use strict";function t(e,t,r){function n(e){var t=e.value();if(void 0===i[t])throw new Error("Attempt to set a Cell to a value not contained in House's possibles list.");delete i[t],i.length--}var o=[],i={1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null,length:9},s=this;this.possibles=i,this.possibleValues=function(){var e,t=[];for(e=1;10>e;e++)i.hasOwnProperty(e)&&t.push(e);return t},this.addCell=function(e){return o.push(e),e.on("update",function(){s.trigger("update",this),n(this)}),s},this.grid=function(){return r},this.type=function(){return e},this.num=function(){return t},this.cells=function(){return o},this.name=function(){return e+" "+t.toString()}}e.House=function(r,n,o){return new e.EventAware(new t(r,n,o))}}(suso),function(e){"use strict";function t(e,t){function r(e){var t=e.value();c.removePossible(t)}var n,o=e,i=[],s={row:0,col:1,block:2},l={1:null,2:null,3:null,4:null,5:null,6:null,7:null,8:null,9:null},u=9,c=this;this.id=function(){return o},this.possibles=l,this.removePossible=function(e){return void 0!==l[e]?(delete l[e],u--,1===u&&("ready"===t.state()?c.setValue(c.possibleValues()[0],"last remaining possible value in cell"):t.seedSolved.push(c)),!0):!1},this.grid=function(){return t},this.value=function(){return n},this.setValue=function(e,t){if(void 0!==n)throw new Error("Attempt to set value on a Cell that already has a value.");n=e,c.possibles=l={},u=0,this.trigger("update",this,t)},this.setHouse=function(e){var t=s[e.type()];if(void 0===t)throw new Error("invalid house");if(void 0!==i[t])throw new Error("Attempt to set "+e.type()+" on a Cell that already has a "+e.type()+".");i[t]=e,e.addCell(this),e.on("update",r)},this.row=function(){return i[s.row]},this.col=function(){return i[s.col]},this.block=function(){return i[s.block]},this.possibleValues=function(){var e,t=[];for(e=1;10>e;e++)l.hasOwnProperty(e)&&t.push(e);return t},this.possibleFlags=function(){var e,t=0;for(e=1;10>e;e++)t=t<<1|(l.hasOwnProperty(e)?1:0);return t},this.coords=function(){return void 0===i[s.row]||void 0===i[s.col]?[]:[i[s.row].num(),i[s.col].num()]}}var r=0;e.Cell=function(n){return new e.EventAware(new t(r++,n))}}(suso),function(e){"use strict";void 0===e.rules&&(e.rules={}),e.rules.hiddenpairs=function(t){var r,n,o,i,s,l,u,c,a,p,f,d=!1,h=t.allGroups();for(r=0;r<h.length;r++)if(n=h[r],o={},!(n.possibleValues().length<3)){for(i=0;9>i;i++)if(s=n.cells()[i],void 0===s.value())for(l=s.possibleValues(),u=0;u<l.length;u++)void 0===o[l[u]]&&(o[l[u]]=[]),o[l[u]].push(s);o=e.filter(o,function(e){return 2===e.length}),e.forEach(o,function(r,n){e.forEach(o,function(e,o){if(o>n&&r[0]===e[0]&&r[1]===e[1])for(c=Math.pow(2,9-n)|Math.pow(2,9-o),a=0;2>a;a++)for(p=r[a].possibleFlags()^c,f=9;p>0;)(1&p)>0&&r[a].removePossible(f)&&(t.trigger("report",r[a],"hidden pairs - remove possible "+f),d=!0),f--,p>>=1})})}return d}}(suso),function(e){"use strict";void 0===e.rules&&(e.rules={}),e.rules.lastInGroup=function(e){var t,r,n,o,i,s,l,u=e.allGroups(),c=!1;for(t=0;t<u.length;t++){for(s={},r=u[t].cells(),n=0;n<r.length;n++)for(o=r[n].possibleValues(),i=0;i<o.length;i++)void 0===s[o[i]]&&(s[o[i]]=[]),s[o[i]].push(r[n]);for(l in s)s.hasOwnProperty(l)&&1===s[l].length&&void 0===s[l][0].value()&&(s[l][0].setValue(parseInt(l,10),"last in group - "+u[t].name()),c=!0)}return c}}(suso),function(e){"use strict";void 0===e.rules&&(e.rules={}),e.rules.pairs=function(t){var r,n,o,i,s,l,u,c,a=!1,p=t.allGroups();for(r=0;r<p.length;r++){for(n=p[r],s={},o=0;9>o;o++)i=n.cells()[o],void 0===i.value()&&2===i.possibleValues().length&&(l=i.possibleValues().join(""),void 0===s[l]&&(s[l]=[]),s[l].push(i));s=e.filter(s,function(e){return 2===e.length}),e.forEach(s,function(r,o){var i=!1,s=o.split("");e.forEach(n.cells(),function(e){e!==r[0]&&e!==r[1]&&(u=e.removePossible(parseInt(s[0],10)),c=e.removePossible(parseInt(s[1],10)),i=i||u||c)}),i&&(a=!0,t.trigger("report",n,"pairs rule - remove possible vals "+s+" from "+n.name()))})}return a}}(suso),function(e){"use strict";void 0===e.rules&&(e.rules={}),e.rules.restrictedPossibleValue=function(e){var t,r,n,o,i=e.allGroups(),s=!1;return i.forEach(function(i){i.possibleValues().forEach(function(l){t=[[],[]],i.cells().forEach(function(e){void 0!==e.possibles[l]&&("block"===i.type()?(n=t[0],o=t[1],-1===n.indexOf(e.row())&&n.push(e.row()),-1===o.indexOf(e.col())&&o.push(e.col())):(r=t[0],-1===r.indexOf(e.block())&&r.push(e.block())))}),"block"===i.type()?t.filter(function(e){return 1===e.length}).forEach(function(t){t[0].cells().forEach(function(r){r.block()!==i&&void 0!==r.possibles[l]&&r.removePossible(l)&&(s=!0,e.trigger("report",t[0],"claimed "+l.toString()+" in "+i.name()+" - remove possibles from intersecting "+t[0].name()))})}):1===t[0].length&&t[0][0].cells().forEach(function(r){r.row()!==i&&r.col()!==i&&void 0!==r.possibles[l]&&r.removePossible(l)&&(s=!0,e.trigger("report",t[0][0],"claimed "+l.toString()+" in "+i.name()+" - remove possibles from intersecting "+t[0][0].name()))})})}),s}}(suso),function(e){"use strict";function t(e){var t=0;if("number"!=typeof e)return null;if(0>=e)return 0;for(;e>0;)t+=1&e,e>>=1;return t}function r(e){var t,r=[];if("number"!=typeof e)return null;if(0>=e)return r;for(t=9;t>0;t--)1===(1&e)&&r.push(t),e>>=1;return r}void 0===e.rules&&(e.rules={}),e.rules.triples=function(e){var n,o,i,s,l,u,c,a=!1,p=e.allGroups();return p.forEach(function(p){n=[],o=[],p.cells().filter(function(e){return void 0===e.value()}).forEach(function(e){i=t(e.possibleFlags()),(2===i||3===i)&&(n.forEach(function(t){t.possibleFlags()&e.possibleFlags()>0&&o.push([t,e])}),n.push(e))}),o.forEach(function(o){n.forEach(function(n){n!==o[0]&&n!==o[1]&&(s=o[0].possibleFlags()|o[1].possibleFlags()|n.possibleFlags(),3===t(s)&&(l=r(s),p.cells().forEach(function(e){if(e!==o[0]&&e!==o[1]&&e!==n)for(u=0;3>u;u++)c|=e.removePossible(l[u])}),c&&(c=!1,a=!0,e.trigger("report",p,"triplet "+l+" in "+p.name()+" - remove other possibles"))))})})}),a}}(suso),function(e){"use strict";void 0===e.views&&(e.views={}),e.views.Preformatted=function(e,t){function r(t,r){var n=e.hRow(s).cells()[r].value();return void 0===n?"-":n.toString()}function n(){for(i="\n",s=0;9>s;s++)i+=l.replace(/\{([0-9])\}/g,r),i+="\n",(2===s||5===s)&&(i+="\n");o.innerHTML=i}var o,i,s,l="{0}{1}{2} {3}{4}{5} {6}{7}{8}",u=[];return this.createStep=function(){return u[u.length]=o.innerHTML,u.length-1},this.renderStep=function(e){o.innerHTML=u[e]},this.grid=e,this.ctrl=t,void 0===t&&(t=document.createElement("div"),t.setAttribute("id","Grid-Display"),document.body.appendChild(t)),o=document.createElement("pre"),t.appendChild(o),e.on("update",n),n()}}(suso),function(e){"use strict";void 0===e.views&&(e.views={}),e.views.Report=function(e){function t(){var e;s&&(0===this.id.indexOf("step")&&(e=parseInt(this.id.substring(4),10)),isNaN(e)||l.renderStep(e))}function r(e,r){var o;o=document.createElement("div"),o.setAttribute("class","report"),n.appendChild(o),void 0!==l&&l.hasOwnProperty("createStep")&&(o.setAttribute("id","step"+l.createStep()),o.addEventListener("mouseover",t)),"string"==typeof e?o.innerHTML=e:"object"==typeof e&&e.hasOwnProperty("coords")?o.innerHTML="cell action: "+e.coords()+(void 0===e.value()?"":" = "+e.value().toString())+(void 0===r?"":" -- "+r):"object"==typeof e&&e.hasOwnProperty("state")?(o.innerHTML=r,("complete"===e.state()||"incomplete"===e.state())&&(s=!0)):o.innerHTML=r}var n,o,i=".report-container { border: solid 2px blue; margin-top: 1em; width: 100%; }\n.report { border-top: solid 1px grey; margin: 2px }\n",s=!1,l=e.gridView;this.grid=e.grid,this.ctrl=e.ctrl,void 0===this.ctrl&&(this.ctrl=document.createElement("div"),this.ctrl.setAttribute("id","Report-Display"),document.body.appendChild(this.ctrl)),o=document.createElement("style"),this.ctrl.appendChild(o),o.innerHTML=i,n=document.createElement("div"),n.setAttribute("class","report-container"),this.ctrl.appendChild(n),n.innerHTML="<h1>Report</h1>",this.grid.on("report",r)}}(suso),function(e){"use strict";void 0===e.views&&(e.views={}),e.views.StaticGrid=function(e,t){function r(t,r){var n=e.hRow(s).cells()[r],o=n.value();return o?"<span class='value'>"+o.toString()+"</span>":"<span class='poss'>"+n.possibleValues().join(" ")+"</span>"}function n(){for(i="",s=0;9>s;s++)i+=u.replace(/\{([0-9])\}/g,r),i+="\n";o.innerHTML=i}var o,i,s,l,u="<div class='row'><span class='cell'>{0}</span><span class='cell'>{1}</span><span class='cell'>{2}</span><span class='cell'>{3}</span><span class='cell'>{4}</span><span class='cell'>{5}</span><span class='cell'>{6}</span><span class='cell'>{7}</span><span class='cell'>{8}</span></div>",c=".grid { display: table; border-top: solid 2px black; border-left: solid 2px black; }\n.row { display: table-row; border-bottom: solid 1px grey; }\n.row:nth-of-type(3n+0) .cell { border-bottom: solid 2px black; }\n.cell { width: 38px; height: 40px; display: table-cell; border-right: solid 1px grey; border-bottom: solid 1px grey; text-align: center; vertical-align: middle; }\ncell:nth-of-type(3n+0) { border-right: solid 2px black; }\n.poss { font-size: 12px; line-height: 10px }\n.value { font-size: 22px; font-weight: bold }\n",a=[];return this.createStep=function(){return a[a.length]=o.innerHTML,a.length-1},this.renderStep=function(e){o.innerHTML=a[e]},this.grid=e,this.ctrl=t,void 0===t&&(t=document.createElement("div"),t.setAttribute("id","Grid-Display"),document.body.appendChild(t)),l=document.createElement("style"),t.appendChild(l),l.innerHTML=c,o=document.createElement("div"),o.setAttribute("class","grid"),t.appendChild(o),e.on("update",n),e.on("report",n),n()}}(suso);